<!doctype html><html lang=en-uk><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>The Only AngularJS Modal Service You'll Ever Need</title><meta property="og:title" content="The Only AngularJS Modal Service You'll Ever Need"><meta name=twitter:title content="The Only AngularJS Modal Service You'll Ever Need"><meta name=description content="Articles on the craft of software development. No ads, no sponsored content."><meta property="og:description" content="Articles on the craft of software development. No ads, no sponsored content."><meta name=twitter:description content="Articles on the craft of software development. No ads, no sponsored content."><meta name=author content="Dave Kerr"><meta property="og:site_name" content="dwmkerr.com"><meta property="og:url" content="https://dwmkerr.com/the-only-angularjs-modal-service-youll-ever-need/"><meta name=twitter:card content="summary"><meta name=twitter:site content="@dwmkerr"><meta name=twitter:creator content="@dwmkerr"><meta property="og:type" content="article"><meta name=generator content="Hugo 0.61.0"><link rel=stylesheet href=https://dwmkerr.comcss/style.css><link rel=icon type=image/x-icon href=https://dwmkerr.com/images/favicon.ico><script type=text/javascript src=https://dwmkerr.comjs/bundle.js></script></head><body><a href=#main class="skip-link p-screen-reader-text">Skip to content</a><svg xmlns="http://www.w3.org/2000/svg" style="display:none" aria-hidden="true"><symbol id="icon-500px" viewBox="0 0 16 16"><g><path d="M3.953 10.512a5.24 5.24.0 006.996 3.141c.625-.262 1.184-.641 1.666-1.122s.859-1.041 1.122-1.666c.272-.647.412-1.331.412-2.037s-.137-1.394-.412-2.037c-.262-.625-.641-1.184-1.122-1.666s-1.041-.859-1.666-1.122a5.226 5.226.0 00-2.037-.413c-.716.0-1.431.144-2.066.413-.509.216-1.372.769-1.875 1.291l-.003.003V.984h7.241c.262-.003.262-.372.262-.491.0-.122.0-.487-.266-.491H4.377a.343.343.0 00-.344.341v6.066c0 .197.244.338.472.384.444.094.544-.047.653-.197l.016-.019c.166-.247.681-.766.688-.772a4.262 4.262.0 013.037-1.25c1.147.0 2.222.444 3.028 1.25a4.245 4.245.0 011.256 3.019 4.236 4.236.0 01-1.25 3.019 4.336 4.336.0 01-3.047 1.25 4.136 4.136.0 01-2.159-.597l.003-3.688c0-.491.213-1.028.572-1.431a2.09 2.09.0 011.588-.716c.594.0 1.15.225 1.566.634.409.406.637.95.637 1.528a2.179 2.179.0 01-2.206 2.197c-.238.0-.672-.106-.691-.109-.25-.075-.356.272-.391.387-.134.441.069.528.109.541.397.125.659.147 1.003.147a3.173 3.173.0 003.169-3.169c0-1.734-1.422-3.144-3.166-3.144-.856.0-1.659.328-2.263.919-.575.566-.903 1.319-.903 2.069v.019c-.003.094-.003 2.306-.006 3.031l-.003-.003c-.328-.363-.653-.919-.869-1.488-.084-.222-.275-.184-.534-.103-.125.034-.469.141-.391.394zm3.722-.865c0 .106.097.2.156.253l.019.019c.1.097.194.147.281.147a.181.181.0 00.131-.05c.044-.041.537-.544.588-.591l.553.55c.05.056.106.088.172.088.088.0.184-.053.284-.156.238-.244.119-.375.063-.438l-.559-.559.584-.588c.128-.137.016-.284-.097-.397-.162-.162-.322-.206-.422-.112l-.581.581-.588-.588a.16.16.0 00-.113-.047c-.078.0-.172.053-.275.156-.181.181-.219.306-.125.406l.588.584-.584.584c-.053.05-.078.103-.075.156zm1.278-7.931c-.938.0-1.938.191-2.669.506a.207.207.0 00-.134.181.753.753.0 00.069.337c.047.116.166.425.4.334a6.689 6.689.0 012.334-.444 6.35 6.35.0 012.469.497c.622.263 1.206.644 1.844 1.194a.22.22.0 00.147.059c.125.0.244-.122.347-.237.169-.191.287-.35.119-.509a6.858 6.858.0 00-2.1-1.356 7.326 7.326.0 00-2.825-.563zM14.006 13.3c-.113-.113-.209-.178-.294-.203s-.162-.006-.222.053l-.056.056a6.32 6.32.0 01-6.938 1.356 6.336 6.336.0 01-2.013-1.356 6.046 6.046.0 01-1.356-2.012c-.288-.713-.381-1.247-.413-1.422-.003-.016-.006-.028-.006-.037-.041-.206-.231-.222-.503-.178-.112.019-.459.072-.428.319v.006a7.261 7.261.0 002.04 3.994 7.266 7.266.0 0010.288.0l.059-.059c.069-.084.134-.225-.159-.516z"/></g></symbol><symbol id="icon-codepen" viewBox="0 0 16 16"><g><path d="M14.777 5.751l-7-4.667a.5.5.0 00-.555.0l-7 4.667a.501.501.0 00-.223.416v4.667c0 .167.084.323.223.416l7 4.667a.5.5.0 00.554.0l7-4.667a.501.501.0 00.223-.416V6.167a.501.501.0 00-.223-.416zM7.5 10.232 4.901 8.5 7.5 6.768 10.099 8.5 7.5 10.232zM8 5.899V2.434l5.599 3.732L11 7.898l-3-2zm-1 0-3 2-2.599-1.732L7 2.435V5.9zM3.099 8.5 1 9.899V7.101L3.099 8.5zM4 9.101l3 2v3.465l-5.599-3.732L4 9.102zm4 2 3-2 2.599 1.732L8 14.565V11.1zM11.901 8.5 14 7.101v2.798L11.901 8.5z"/></g></symbol><symbol id="icon-dribbble" viewBox="0 0 16 16"><g><path d="M8 16c-4.412.0-8-3.588-8-8s3.587-8 8-8c4.412.0 8 3.587 8 8s-3.588 8-8 8zm6.747-6.906c-.234-.075-2.116-.634-4.256-.291a29.7 29.7.0 011.328 4.872 6.845 6.845.0 002.928-4.581zM10.669 14.3c-.103-.6-.497-2.688-1.456-5.181-.016.006-.031.009-.044.016-3.856 1.344-5.241 4.016-5.362 4.266a6.807 6.807.0 006.863.9zm-7.747-1.722c.156-.266 2.031-3.369 5.553-4.509a7.04 7.04.0 01.269-.081 24.04 24.04.0 00-.553-1.159c-3.409 1.022-6.722.978-7.022.975-.003.069-.003.138-.003.209.0 1.753.666 3.356 1.756 4.566zM1.313 6.609c.306.003 3.122.016 6.319-.831a43.092 43.092.0 00-2.534-3.953A6.854 6.854.0 001.314 6.609zM6.4 1.366a36.612 36.612.0 012.55 4c2.431-.909 3.459-2.294 3.581-2.469A6.799 6.799.0 006.4 1.366zm6.891 2.325c-.144.194-1.291 1.663-3.816 2.694.159.325.313.656.453.991.05.119.1.234.147.353 2.275-.284 4.534.172 4.759.219a6.816 6.816.0 00-1.544-4.256z"/></g></symbol><symbol id="icon-facebook" viewBox="0 0 16 16"><g><path d="M9.5 3H12V0H9.5C7.57.0 6 1.57 6 3.5V5H4v3h2v8h3V8h2.5l.5-3H9V3.5c0-.271.229-.5.5-.5z"/></g></symbol><symbol id="icon-feed" viewBox="0 0 16 16"><g><path d="M2.13 11.733c-1.175.0-2.13.958-2.13 2.126.0 1.174.955 2.122 2.13 2.122a2.126 2.126.0 002.133-2.122A2.133 2.133.0 002.13 11.733zM.002 5.436v3.067c1.997.0 3.874.781 5.288 2.196a7.45 7.45.0 012.192 5.302h3.08c0-5.825-4.739-10.564-10.56-10.564zM.006.0v3.068C7.128 3.068 12.924 8.87 12.924 16H16C16 7.18 8.824.0.006.0z"/></g></symbol><symbol id="icon-flickr" viewBox="0 0 16 16"><g><path d="M0 8.5a3.5 3.5.0 117 0 3.5 3.5.0 01-7 0zm9 0a3.5 3.5.0 117 0 3.5 3.5.0 01-7 0z"/></g></symbol><symbol id="icon-github" viewBox="0 0 16 16"><g><path d="M8 .198A8 8 0 005.471 15.789c.4.074.547-.174.547-.385.0-.191-.008-.821-.011-1.489-2.226.484-2.695-.944-2.695-.944-.364-.925-.888-1.171-.888-1.171-.726-.497.055-.486.055-.486.803.056 1.226.824 1.226.824.714 1.223 1.872.869 2.328.665.072-.517.279-.87.508-1.07-1.777-.202-3.645-.888-3.645-3.954.0-.873.313-1.587.824-2.147-.083-.202-.357-1.015.077-2.117.0.0.672-.215 2.201.82A7.672 7.672.0 018 4.066c.68.003 1.365.092 2.004.269 1.527-1.035 2.198-.82 2.198-.82.435 1.102.162 1.916.079 2.117.513.56.823 1.274.823 2.147.0 3.073-1.872 3.749-3.653 3.947.287.248.543.735.543 1.481.0 1.07-.009 1.932-.009 2.195.0.213.144.462.55.384A8 8 0 008.001.196z"/></g></symbol><symbol id="icon-gitlab" viewBox="0 0 28 28"><g><path d="M1.625 11.031 14 26.89.437 17.046a1.092 1.092.0 01-.391-1.203l1.578-4.813zm7.219.0h10.313L14.001 26.89zM5.75 1.469l3.094 9.562H1.625l3.094-9.562a.548.548.0 011.031.0zm20.625 9.562 1.578 4.813a1.09 1.09.0 01-.391 1.203l-13.563 9.844 12.375-15.859zm0 0h-7.219l3.094-9.562a.548.548.0 011.031.0z"/></g></symbol><symbol id="icon-google-plus" viewBox="0 0 16 16"><g><path d="M5.091 7.147v1.747h2.888c-.116.75-.872 2.197-2.888 2.197-1.737.0-3.156-1.441-3.156-3.216s1.419-3.216 3.156-3.216c.991.0 1.65.422 2.028.784L8.5 4.112c-.888-.828-2.037-1.331-3.409-1.331C2.275 2.784.0 5.059.0 7.875s2.275 5.091 5.091 5.091c2.937.0 4.888-2.066 4.888-4.975.0-.334-.037-.591-.081-.844H5.092zM16 7h-1.5V5.5H13V7h-1.5v1.5H13V10h1.5V8.5H16z"/></g></symbol><symbol id="icon-instagram" viewBox="0 0 22 22"><g><path d="M15.445.0H6.554A6.559 6.559.0 000 6.554v8.891A6.559 6.559.0 006.554 22h8.891a6.56 6.56.0 006.554-6.555V6.554A6.557 6.557.0 0015.445.0zm4.342 15.445a4.343 4.343.0 01-4.342 4.342H6.554a4.341 4.341.0 01-4.341-4.342V6.554a4.34 4.34.0 014.341-4.341h8.891a4.342 4.342.0 014.341 4.341l.001 8.891z"/><path d="M11 5.312A5.693 5.693.0 005.312 11 5.694 5.694.0 0011 16.688 5.694 5.694.0 0016.688 11 5.693 5.693.0 0011 5.312zm0 9.163a3.475 3.475.0 11-.001-6.95 3.475 3.475.0 01.001 6.95zm5.7-10.484a1.363 1.363.0 11-1.364 1.364c0-.752.51-1.364 1.364-1.364z"/></g></symbol><symbol id="icon-linkedin" viewBox="0 0 16 16"><g><path d="M6 6h2.767v1.418h.04C9.192 6.727 10.134 6 11.539 6 14.46 6 15 7.818 15 10.183V15h-2.885v-4.27c0-1.018-.021-2.329-1.5-2.329-1.502.0-1.732 1.109-1.732 2.255V15H6V6zM1 6h3v9H1V6zM4 3.5a1.5 1.5.0 11-3.001-.001A1.5 1.5.0 014 3.5z"/></g></symbol><symbol id="icon-mail" viewBox="0 0 22 18"><g><path fill="#000" d="M0 17.225V.776h22v16.447H0v.002zm3.011-1.815h15.978l-5.111-5.115L11 13.179l-2.877-2.883-5.112 5.114zm-1.216-1.275 5.077-5.09L1.795 3.98v10.155zm13.332-5.09 5.079 5.09V3.979l-5.079 5.066zm-4.126 1.588 8.022-8.027-16.045-.001 8.023 8.028z"/></g></symbol><symbol id="icon-medium" viewBox="0 0 24 24"><g><path d="M22.085 4.733 24 2.901V2.5h-6.634l-4.728 11.768L7.259 2.5H.303v.401L2.54 5.594c.218.199.332.49.303.783V16.96c.069.381-.055.773-.323 1.05L0 21.064v.396h7.145v-.401l-2.52-3.049a1.244 1.244.0 01-.347-1.05V7.806l6.272 13.659h.729l5.393-13.659v10.881c0 .287.0.346-.188.534l-1.94 1.877v.402h9.412v-.401l-1.87-1.831a.556.556.0 01-.214-.534V5.267a.554.554.0 01.213-.534z"/></g></symbol><symbol id="icon-npm" viewBox="0 0 16 16"><g><path d="M0 0v16h16V0H0zm13 13h-2V5H8v8H3V3h10v10z"/></g></symbol><symbol id="icon-pinterest" viewBox="0 0 16 16"><g><path d="M8 1.069A6.93 6.93.0 005.475 14.453c-.059-.547-.116-1.391.025-1.988.125-.541.813-3.444.813-3.444s-.206-.416-.206-1.028c0-.963.559-1.684 1.253-1.684.591.0.878.444.878.975.0.594-.378 1.484-.575 2.306-.166.691.344 1.253 1.025 1.253 1.231.0 2.178-1.3 2.178-3.175.0-1.659-1.194-2.819-2.894-2.819-1.972.0-3.128 1.478-3.128 3.009.0.597.228 1.234.516 1.581.056.069.066.128.047.2a95.89 95.89.0 01-.194.787c-.031.128-.1.153-.231.094-.866-.403-1.406-1.669-1.406-2.684.0-2.188 1.587-4.194 4.578-4.194 2.403.0 4.272 1.712 4.272 4.003.0 2.388-1.506 4.313-3.597 4.313-.703.0-1.362-.366-1.588-.797.0.0-.347 1.322-.431 1.647-.156.603-.578 1.356-.862 1.816a6.93 6.93.0 008.984-6.622 6.931 6.931.0 00-6.931-6.934z"/></g></symbol><symbol id="icon-search" viewBox="0 0 16 16"><g><path d="M15.504 13.616l-3.79-3.223c-.392-.353-.811-.514-1.149-.499a6 6 0 10-.672.672c-.016.338.146.757.499 1.149l3.223 3.79c.552.613 1.453.665 2.003.115s.498-1.452-.115-2.003zM6 10a4 4 0 110-8 4 4 0 010 8z"/></g></symbol><symbol id="icon-tumblr" viewBox="0 0 16 16"><g><path d="M9.001 7v3.659c0 .928-.012 1.463.086 1.727.098.262.342.534.609.691.354.212.758.318 1.214.318.81.0 1.289-.107 2.09-.633v2.405a9.089 9.089.0 01-1.833.639A7.93 7.93.0 019.369 16a4.9 4.9.0 01-1.725-.276 4.195 4.195.0 01-1.438-.79c-.398-.343-.672-.706-.826-1.091s-.23-.944-.23-1.676V6.556H3.003V4.29c.628-.204 1.331-.497 1.778-.877a4.386 4.386.0 001.08-1.374C6.133 1.505 6.32.825 6.422.0h2.579v4H13v3H9.001z"/></g></symbol><symbol id="icon-twitter" viewBox="0 0 16 16"><g><path d="M16 3.538a6.461 6.461.0 01-1.884.516 3.301 3.301.0 001.444-1.816 6.607 6.607.0 01-2.084.797 3.28 3.28.0 00-2.397-1.034 3.28 3.28.0 00-3.197 4.028 9.321 9.321.0 01-6.766-3.431 3.284 3.284.0 001.015 4.381A3.301 3.301.0 01.643 6.57v.041A3.283 3.283.0 003.277 9.83a3.291 3.291.0 01-1.485.057 3.293 3.293.0 003.066 2.281 6.586 6.586.0 01-4.862 1.359 9.286 9.286.0 005.034 1.475c6.037.0 9.341-5.003 9.341-9.341.0-.144-.003-.284-.009-.425a6.59 6.59.0 001.637-1.697z"/></g></symbol><symbol id="icon-vimeo" viewBox="0 0 16 16"><g><path d="M15.994 4.281c-.072 1.556-1.159 3.691-3.263 6.397-2.175 2.825-4.016 4.241-5.522 4.241-.931.0-1.722-.859-2.366-2.581-.431-1.578-.859-3.156-1.291-4.734-.478-1.722-.991-2.581-1.541-2.581-.119.0-.538.253-1.256.753l-.753-.969c.791-.694 1.569-1.388 2.334-2.081 1.053-.909 1.844-1.387 2.372-1.438 1.244-.119 2.013.731 2.3 2.553.309 1.966.525 3.188.647 3.666.359 1.631.753 2.447 1.184 2.447.334.0.838-.528 1.509-1.588.669-1.056 1.028-1.862 1.078-2.416.097-.912-.262-1.372-1.078-1.372a2.98 2.98.0 00-1.184.263c.787-2.575 2.287-3.825 4.506-3.753 1.641.044 2.416 1.109 2.322 3.194z"/></g></symbol><symbol id="icon-wordpress" viewBox="0 0 16 16"><g><path d="M2 8c0 2.313 1.38 4.312 3.382 5.259L2.52 5.622A5.693 5.693.0 002 8zm10.05-.295c0-.722-.266-1.222-.495-1.612-.304-.482-.589-.889-.589-1.371.0-.537.418-1.037 1.008-1.037.027.0.052.003.078.005A6.064 6.064.0 008 2.156 6.036 6.036.0 002.987 4.79c.141.004.274.007.386.007.627.0 1.599-.074 1.599-.074.323-.018.361.444.038.482.0.0-.325.037-.687.055l2.185 6.33 1.313-3.835-.935-2.495a12.304 12.304.0 01-.629-.055c-.323-.019-.285-.5.038-.482.0.0.991.074 1.58.074.627.0 1.599-.074 1.599-.074.323-.018.362.444.038.482.0.0-.326.037-.687.055l2.168 6.282.599-1.947c.259-.809.457-1.389.457-1.889zm-3.945.806-1.8 5.095a6.148 6.148.0 003.687-.093.52.52.0 01-.043-.081L8.105 8.511zm5.16-3.315c.026.186.04.386.04.601.0.593-.114 1.259-.456 2.093l-1.833 5.16c1.784-1.013 2.983-2.895 2.983-5.051a5.697 5.697.0 00-.735-2.803zM8 0a8 8 0 100 16A8 8 0 008 0zm0 15A7 7 0 118 1a7 7 0 010 14z"/></g></symbol><symbol id="icon-youtube" viewBox="0 0 16 16"><g><path d="M15.841 4.8s-.156-1.103-.637-1.587c-.609-.637-1.291-.641-1.603-.678-2.237-.163-5.597-.163-5.597-.163h-.006s-3.359.0-5.597.163c-.313.038-.994.041-1.603.678C.317 3.697.164 4.8.164 4.8S.005 6.094.005 7.391v1.213c0 1.294.159 2.591.159 2.591s.156 1.103.634 1.588c.609.637 1.409.616 1.766.684 1.281.122 5.441.159 5.441.159s3.363-.006 5.6-.166c.313-.037.994-.041 1.603-.678.481-.484.637-1.588.637-1.588s.159-1.294.159-2.591V7.39c-.003-1.294-.162-2.591-.162-2.591zm-9.494 5.275V5.578l4.322 2.256-4.322 2.241z"/></g></symbol></svg><header class=l-header><p class="c-title p-title"><a href=https://dwmkerr.com class=p-title__link>dwmkerr.com</a></p><p class=p-subtitle>Articles on the craft of software development. No ads, no sponsored content.</p></header><main id=main class=l-main><article class=p-article><header><h1>The Only AngularJS Modal Service You'll Ever Need</h1><div><div class=c-time>Posted on
<time datetime=2014-06-16T00:48:12Z>Jun 16, 2014</time></div><a href=https://dwmkerr.com/tags/angularjs class=c-tag>AngularJS</a>
<a href=https://dwmkerr.com/tags/codeproject class=c-tag>CodeProject</a>
<a href=https://dwmkerr.com/tags/javascript class=c-tag>Javascript</a>
<a href=https://dwmkerr.com/tags/bootstrap class=c-tag>Bootstrap</a></div></header><section id=js-article class=p-article__body><p>If you need modals in an AngularJS application, look no further. I'll show you how to use the <a href=https://github.com/dwmkerr/angular-modal-service>Angular Modal Service</a> to add Bootstrap Modals or your own custom modals to your application.</p><p><a href=http://jsfiddle.net/dwmkerr/8MVLJ/>See it in a fiddle</a> or check out <a href=http://dwmkerr.github.io/angular-modal-service>a full set of samples online</a>.</p><h4 id=contents>Contents</h4><ol><li>[Using the Angular Modal Service](#UsingTheAngular ModalService)</li><li><a href=#AQuickExample>A Quick Example</a></li><li><a href=#DesignGoals>Design Goals</a></li><li><a href=#HowItWorks>How It Works</a></li><li><a href=#WrappingUp>Wrapping Up</a></li></ol><h2 id=using-the-angular-modal-service>Using the Angular Modal Service</h2><p>Here's how you can use the Angular Modal Service to add a bootstrap modal to your application.</p><h4 id=step-1-install-with-bower>Step 1: Install with Bower</h4><p>Install the service with bower:</p><pre><code>bower install angular-modal-service --save
</code></pre><p>If you don't use bower, just get the source directly from the <a href=https://github.com/dwmkerr/angular-modal-service/tree/master/dst><code>dst</code></a> folder of the repo.</p><h4 id=step-2-include-the-javascript>Step 2: Include the JavaScript</h4><p>Include the JavaScript from the <code>dst</code> folder or require it with require.js:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bower_components\angular-modal-service\dst\angular-modal-service.min.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</code></pre></div><h4 id=step-3-add-it-as-a-dependency>Step 3: Add it as a dependency</h4><p>Make sure the <code>angularModalService</code> module is listed as a required module for your application:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>app</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>angular</span>.<span style=color:#a6e22e>module</span>(<span style=color:#e6db74>&#39;myApp&#39;</span>, [<span style=color:#e6db74>&#39;angularModalService&#39;</span>]);
</code></pre></div><h4 id=step-4-show-the-modal>Step 4: Show the Modal</h4><p>Inject <code>ModalService</code> into any controller, directive or service and call the <code>showModal</code> function to show a modal:</p><pre><code class=language-language data-lang=language>app.controller('SampleController', function($scope, ModalService) {

  ModalService.showModal({
    templateUrl: &quot;template.html&quot;,
    controller: &quot;ModalController&quot;
  }).then(function(modal) {
    
    //it's a bootstrap element, use 'modal' to show it
    modal.element.modal();
    modal.close.then(function(result) {
      console.log(result);
    });
  });

);
</code></pre><p>This code loads the HTML from <code>template.html</code>, adds it to the DOM, creates a scope for it and creates an instance of a <code>ModalController</code>.</p><p>When this is done, the promise returned by the <code>showModal</code> function resolves and you get a <code>modal</code> object. This object contains the element created. If it's a Bootstrap modal just call <code>modal</code> to show it, if it's a custom one you can show it by changing its CSS styles or using whatever APIs are provided. There's an example ofa custom modal in <a href=http://dwmkerr.github.io/angular-modal-service/>the samples</a>.</p><h4 id=step-5-close-the-modal>Step 5: Close the Modal</h4><p>The controller that is created always has one extra parameter injected into it - a function called <code>close</code>. Call this function to close the modal, anything you pass to it is passed to the caller as the <code>result</code> object.</p><pre><code class=language-language data-lang=language>app.controller('ModalController', function($scope, close) {
  
  // when you need to close the modal, call close
  close(&quot;Success!&quot;);
});
</code></pre><p>You can pass a number of milliseconds to wait before destroying the DOM element as an optional second parameter to <code>close</code> - this is useful if the closing of the modal is animated and you don't want it to disappear before the animation completes.</p><h2 id=a-quick-example>A Quick Example</h2><p>Here's a fiddle of the modal service in action:</p><p>One thing to note in this examples is that the template is just declared in the DOM - this works fine because the service always checks the template cache before attempting to load it from the server.</p><p>There are more examples at <a href=http://dwmkerr.github.io/angular-modal-service/>dwmkerr.github.io/angular-modal-service</a>.</p><h2 id=design-goals>Design Goals</h2><p>There are some other services for handling modals out there, notably <a href=https://github.com/Fundoo-Solutions/angularjs-modal-service>Fundoo's Modal Service</a> and a few others. However, the design goals for my service were slightly different:</p><ol><li><strong>No link to bootstrap</strong>. Bootstrap modals are complex with lots of options - if you want to use them then that's great, the service should work with them, but the complexity of the options for Bootstrap Modals should not increase the complexity of the service.</li><li><strong>Extremely simple code</strong>. It's rare you'll write something that it will suit everyone's need. Rather than trying to please everyone, I want a service that is simple enough to understand so that it can be easily adapted by others.</li></ol><p>So the core goal here is simplicity - if others can understand the code, then they can more effectively decide whether it's what they need, or build upon it.</p><p>With these design goals in mind I built the angular modal service.</p><h2 id=how-it-works>How It Works</h2><p>I'm going to walk through a slightly simplified version of the code because it actually illustrates quite a few important concepts when working with AngularJS.</p><p>One of the things that's useful to know is that this service creates a DOM element, builds a scope for it and instantiates a controller for it - what we're doing is <em>very</em> similar to what AngularJS does behind the scenes when a directive is created.</p><p>So let's dive in. We're going to define a service, so we need a module.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>module</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>angular</span>.<span style=color:#a6e22e>module</span>(<span style=color:#e6db74>&#39;angularModalService&#39;</span>, []);
</code></pre></div><p>Now we have our module, we can define our service. I tend to write services in the form of classes, but this is a personal choice - it's just as valid to return a javascript object that contains functions and data.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>factory</span>(<span style=color:#e6db74>&#39;ModalService&#39;</span>, [<span style=color:#e6db74>&#39;$document&#39;</span>, <span style=color:#e6db74>&#39;$compile&#39;</span>, <span style=color:#e6db74>&#39;$controller&#39;</span>, <span style=color:#e6db74>&#39;$http&#39;</span>, <span style=color:#e6db74>&#39;$rootScope&#39;</span>, <span style=color:#e6db74>&#39;$q&#39;</span>, <span style=color:#e6db74>&#39;$timeout&#39;</span>,
    <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>$document</span>, <span style=color:#a6e22e>$compile</span>, <span style=color:#a6e22e>$controller</span>, <span style=color:#a6e22e>$http</span>, <span style=color:#a6e22e>$rootScope</span>, <span style=color:#a6e22e>$q</span>, <span style=color:#a6e22e>$timeout</span>) {
</code></pre></div><p>I need a lot of injected components, we'll see why as we continue. I also use the explicit form of the function which takes the parameters as strings - this is the only safe way to write an injected function if you are minifying code.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>body</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$document</span>.<span style=color:#a6e22e>find</span>(<span style=color:#e6db74>&#39;body&#39;</span>);    
    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>ModalService</span>() {
      <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>self</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>;
</code></pre></div><p>I use the <code>$document</code> object to get the body element, which the modal will be appended to. I then create a class function and record <code>this</code> as self, so that I can refer to the class instance in callbacks and so on.</p><p>The next part of the code creates a function that will return the template, given either a raw template string or a template url. The reason we wrap this function like this is that the operation will either be synchronous or asynchronous, and I don't want the caller to care. So we use promises to wrap the logic.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>getTemplate</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>template</span>, <span style=color:#a6e22e>templateUrl</span>) {
  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>deferred</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$q</span>.<span style=color:#a6e22e>defer</span>();
  <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>template</span>) {
    <span style=color:#a6e22e>deferred</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>template</span>);
  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>templateUrl</span>) {
    <span style=color:#a6e22e>$http</span>({<span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;GET&#39;</span>, <span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>templateUrl</span>, <span style=color:#a6e22e>cache</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>})
    .<span style=color:#a6e22e>then</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>result</span>) {
      <span style=color:#a6e22e>deferred</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>data</span>);
    })
    .<span style=color:#66d9ef>catch</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>error</span>) {
      <span style=color:#a6e22e>deferred</span>.<span style=color:#a6e22e>reject</span>(<span style=color:#a6e22e>error</span>);
    });
  } <span style=color:#66d9ef>else</span> {
    <span style=color:#a6e22e>deferred</span>.<span style=color:#a6e22e>reject</span>(<span style=color:#e6db74>&#34;No template or templateUrl has been specified.&#34;</span>);
  }
  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>deferred</span>.<span style=color:#a6e22e>promise</span>;
};
</code></pre></div><p>If any of this seems confusing, check out my article <a href=http://www.dwmkerr.com/promises-in-angularjs-the-definitive-guide/>AngularJS Promises - The Definitive Guide</a>.</p><p>Now to the main function.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>self</span>.<span style=color:#a6e22e>showModal</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>options</span>) {        
  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>deferred</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$q</span>.<span style=color:#a6e22e>defer</span>();
</code></pre></div><p>The <code>showModal</code> function is going to have to do all sorts of async work - loading the template from the server and so on. So we are going to create a <code>deferred</code> object and build a promise to return to the caller.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>controller</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>controller</span>;
<span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>controller</span>) {
  <span style=color:#a6e22e>deferred</span>.<span style=color:#a6e22e>reject</span>(<span style=color:#e6db74>&#34;No controller has been specified.&#34;</span>);
  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>deferred</span>.<span style=color:#a6e22e>promise</span>;
}
</code></pre></div><p>Now we validate that a controller has been passed in as part of the options. Notice how just like in <code>getTemplate</code> we use the <code>reject</code> function to deal with error cases. Again, if error handling with promises seems unfamiliar, check out <a href=http://www.dwmkerr.com/promises-in-angularjs-the-definitive-guide/>AngularJS Promises - The Definitive Guide</a>.</p><p>Next we deal with the template.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>getTemplate</span>(<span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>template</span>, <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>templateUrl</span>)
  .<span style=color:#a6e22e>then</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>template</span>) {
</code></pre></div><p>We've used the <code>getTemplate</code> function to get the template, sync or async it doesn't matter, our logic is the same.</p><p>Now we can build a new scope for our modal.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>modalScope</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$rootScope</span>.<span style=color:#a6e22e>$new</span>();
</code></pre></div><p>We'll refer to this a lot later on. Now for some cleverness.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>closeDeferred</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$q</span>.<span style=color:#a6e22e>defer</span>();
<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>inputs</span> <span style=color:#f92672>=</span> {
  <span style=color:#a6e22e>$scope</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>modalScope</span>,
  <span style=color:#a6e22e>close</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>result</span>, <span style=color:#a6e22e>delay</span>) {
    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>delay</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>undefined</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>delay</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) <span style=color:#a6e22e>delay</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
    <span style=color:#a6e22e>$timeout</span>(<span style=color:#66d9ef>function</span> () {
      <span style=color:#a6e22e>closeDeferred</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>result</span>);
    }, <span style=color:#a6e22e>delay</span>);
  }
};
</code></pre></div><p>This requires some explanation. First, we create a new <code>deferred</code> object. This is going to be used to build a promise that is resolved when the modal closes.</p><p>Now we build an <code>input</code> object. This contains parameters we want to inject to the controller we're going to create. Any parameters the controller needs, such as <code>$element</code>, <code>$timeout</code> or whatever will be injected by angular. We're just going to make sure that the <code>$scope</code> that is injected is the one we've just created, and that we also inject a function called &lsquo;close&rsquo;. This function simply resolves the promise we've created after a specified timeout.</p><p>This means that any controller for a modal can take <code>close</code> as a parameter, and we'll inject the function that resolves the promise. This promise is returned to the consumer so that they can take action when the modal closes. We also allow the controller to pass a variable to <code>close</code> which is passed to the <code>resolve</code> function as well.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>inputs</span>) {
  <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>inputName</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>inputs</span>) {
    <span style=color:#a6e22e>inputs</span>[<span style=color:#a6e22e>inputName</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>inputs</span>[<span style=color:#a6e22e>inputName</span>];
  }
}
</code></pre></div><p>Without the this code, the service is close to useless. What we do here is allow the caller to provide extra inputs to the controller. Imagine we have a list of items, maybe books for a library program, and when the use clicks on one we want to show a modal. The code that shows the modal needs to pass the selected book to the modal controller - by adding it to the <code>inputs</code> object, the book can be injected into the controller. This allows to client to pass data <strong>to</strong> the controller, with the parameter of the <code>close</code> function used to return data <strong>from</strong> the controller.</p><p>Ready for some lower level Angular?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>modalController</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$controller</span>(<span style=color:#a6e22e>controller</span>, <span style=color:#a6e22e>inputs</span>);
<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>modalElementTemplate</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>angular</span>.<span style=color:#a6e22e>element</span>(<span style=color:#a6e22e>template</span>);
<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>linkFn</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>$compile</span>(<span style=color:#a6e22e>modalElementTemplate</span>);
<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>modalElement</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>linkFn</span>(<span style=color:#a6e22e>modalScope</span>);
</code></pre></div><p>Four innocuous lines that are actually quite complex.</p><ol><li>First, we create an instance of the controller with name <code>controller</code>. Regardless of what AngularJS injects, we provide <code>inputs</code> to be injected as well.</li><li>Now we turn our raw template html into an AngularJS DOM element. AngularJS always works with jQuery or jQuery Lite elements, the <code>angular.element</code> function takes raw HTML and turns it into a DOM element we can work with.</li><li>Now we <code>$compile</code> the element. This step goes over the DOM and expands all directives. We're turning raw DOM elements into elements that are expanded into directives, but we haven't yet linked this set of elements into a scope. This is the first step of the compile/link process.</li><li>Finally, we can link the element. The <code>$compile</code> function returns a link function which we call with a scope to link the DOM elements (fully expanded) to the specified scope.</li></ol><p>This is very similar to AngularJS actually handles directives itself - creating a scope, loading a template, turning it into an element, compiling it and linking it.</p><p>Why are compile and link separate steps? Think of it like this, the work that is done in compile is actually identical for each instance of a directive (or modal in our case). It's not related to an <em>instance</em> of a directive or modal, it's just expanding the elements and directives. So this work can be done once only, saving a lot of time - then we just call link to create an <em>instance</em> of our element, bound to a specific scope. So link logic is always per instance (you have a scope, you can <code>$watch</code> and so on) whereas compile logic is per <em>type</em> of directive.</p><p>Based on this, we could in fact cache the results of the compile function on a per-template basis, as they can be reused and linked to a scope as necessary. However this is an optimisation that is currently left out.</p><p>Now we can add the fully built element to the DOM and build our return object.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>append</span>(<span style=color:#a6e22e>modalElement</span>);

<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>modal</span> <span style=color:#f92672>=</span> {
  <span style=color:#a6e22e>controller</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>modalController</span>,
  <span style=color:#a6e22e>scope</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>modalScope</span>,
  <span style=color:#a6e22e>element</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>modalElement</span>,
  <span style=color:#a6e22e>close</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>closeDeferred</span>.<span style=color:#a6e22e>promise</span>
};
</code></pre></div><p>We return the four things the caller might need - the controller, scope, element and close promise. When the close promise is resolved, we also want to clean up:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>modal</span>.<span style=color:#a6e22e>close</span>.<span style=color:#a6e22e>then</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>result</span>) {
  <span style=color:#a6e22e>modalScope</span>.<span style=color:#a6e22e>$destroy</span>();
  <span style=color:#a6e22e>modalElement</span>.<span style=color:#a6e22e>remove</span>();
});

<span style=color:#a6e22e>deferred</span>.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>modal</span>);
</code></pre></div><p>So when <code>close</code> is resolved, whatever happens we'll destroy the scope and clean up the DOM. Now we can resolve our promise with the <code>modal</code> object we've built&mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>  .<span style=color:#66d9ef>catch</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>error</span>) {
  <span style=color:#a6e22e>deferred</span>.<span style=color:#a6e22e>reject</span>(<span style=color:#a6e22e>error</span>);
});
<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>deferred</span>.<span style=color:#a6e22e>promise</span>;
</code></pre></div><p>&mldr;and we can pass errors that occured during <code>getTemplate</code> to the caller and finally return the promise we've built.</p><p>That's it! With this design we handle errors correctly, can pass data to and from the modal, clean up after ourselves and make sure that units of asynchronous work are handled with the standard pattern of promises.</p><h2 id=wrapping-up>Wrapping Up</h2><p>I hope you've found the service and some of the details of the code useful, as always comments are welcome, fork the code and have a play - let me know if you think of improvements or have questions,</p></section><footer><div id=disqus_thread></div><script>var disqus_shortname='dwmkerr';(function(){var d=document,s=d.createElement('script');s.src='https://'+disqus_shortname+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><nav class="p-pagination c-pagination"><div class=c-pagination__ctrl><div class=c-pagination__newer><a href=https://dwmkerr.com/fixing-memory-leaks-in-angularjs-applications/>Newer</a></div><div class=c-pagination__older><a href=https://dwmkerr.com/practical-angularjs-part2/>Older</a></div></div></nav><section class=p-related><h3>See Also</h3><ul id=slider class=p-related__list><li class="p-related__item js-related__item"><a href=/promises-in-angularjs-the-definitive-guide/><span>AngularJS Promises - The Definitive Guide</span></a></li><li class="p-related__item js-related__item"><a href=/practical-angularjs-part-2/><span>Practical AngularJS Part 2</span></a></li><li class="p-related__item js-related__item"><a href=/langtons-ant-in-javascript/><span>Langton's Ant in Javascript</span></a></li><li class="p-related__item js-related__item"><a href=/introducing-practical-angularjs/><span>Introducing Practical AngularJS</span></a></li><li class="p-related__item js-related__item"><a href=/better-specifications/><span>Better Specifications</span></a></li><li class="p-related__item js-related__item"><a href=/a-great-read-for-javascript-newcomers/><span>A great read for JavaScript newcomers</span></a></li></ul></section><aside class=p-author><div class="c-avatar p-author__avatar"><img alt="Author Avatar" src=/images/avatar.jpeg></div><div class=p-author__body><p class="c-title p-author__name">Dave Kerr</p><p>Climber, Coder, Techology Consultant. Views expressed are my own.</p></div></aside></footer></article></main><nav class="l-nav p-menu"><ul class=p-menu__lists><li class=p-menu__listitem><a href=/>Blog</a></li><li class=p-menu__listitem><a href=/page/speaking/>Speaking</a></li><li class=p-menu__listitem><a href=/page/about/>About</a></li></ul></nav><footer class=l-footer><ul class=c-links><li class=c-links__item><a href=https://twitter.com/dwmkerr target=_blank><svg viewBox="0 0 64 64" class="c-links__icon"><title>twitter</title><use xlink:href="#icon-twitter"/></svg></a></li><li class=c-links__item><a href=https://github.com/dwmkerr target=_blank><svg viewBox="0 0 64 64" class="c-links__icon"><title>github</title><use xlink:href="#icon-github"/></svg></a></li><li class=c-links__item><a href=https://www.npmjs.com/dwmkerr target=_blank><svg viewBox="0 0 64 64" class="c-links__icon"><title>npm</title><use xlink:href="#icon-npm"/></svg></a></li><li class=c-links__item><a href=https://linkedin.com/in/dwmkerr target=_blank><svg viewBox="0 0 64 64" class="c-links__icon"><title>linkedin</title><use xlink:href="#icon-linkedin"/></svg></a></li></ul><p class=p-copyright>Copright &copy; Dave Kerr</p></footer><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-41728580-1','auto');ga('send','pageview');</script></body></html>